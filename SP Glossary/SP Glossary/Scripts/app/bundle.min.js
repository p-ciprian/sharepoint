(function(n){var t=n.module("app",[])})(angular=angular||window.angular);$(document).ready(function(){$(window).keydown(function(n){if(n.keyCode==13)return n.preventDefault(),!1})}),function(n){var t=function(){return{restrict:"A",scope:{scrollTo:"@"},link:function(n,t){var i=n.scrollTo;t.on("click",function(){document.getElementById(i)&&$("#s4-workspace").animate({scrollTop:document.getElementById(i).offsetTop},"slow","swing",null)})}}};n.module("app").directive("scrollTo",t)}(angular=angular||window.angular),function(n){var t=function(){return{restrict:"A",scope:{userCanEdit:"="},link:function(n){n.$watch("userCanEdit",function(n,t){if(n!==t&&n){var r=decodeURIComponent(JSRequest.QueryString.SPHostUrl),i=decodeURIComponent(JSRequest.QueryString.SPAppWebUrl),u="<li class='ms-core-suiteLink'>                                <a class='ms-core-suiteLink-a' href='"+i+"/Pages/Instructions.aspx' >Instructions<\/a>                             <\/li>",f="<li class='ms-core-suiteLink'>                                <a class='ms-core-suiteLink-a' href='Settings.aspx?SPHostUrl="+r+"&SPLanguage=en%2DUS&SPClientTag=0&SPProductNumber=15%2E0%2E4787%2E1000&SPAppWebUrl="+i+"'>Settings<\/a>                             <\/li>",e="<li class='ms-core-suiteLink'>                                <a class='ms-core-suiteLink-a' href='"+i+"/Lists/Terms/AllItems.aspx' >Edit Terms<\/a>                             <\/li>";$(".ms-core-suiteLinkList").prepend(u);$(".ms-core-suiteLinkList").prepend(f);$(".ms-core-suiteLinkList").prepend(e)}})}}};n.module("app").directive("userCanEdit",t)}(angular=angular||window.angular),function(n){var t=["$http","$q",function(n,t){var r=[],u=!1;JSRequest.EnsureSetup();var c=decodeURIComponent(JSRequest.QueryString.SPHostUrl),i=decodeURIComponent(JSRequest.QueryString.SPAppWebUrl),f="Terms",e=function(){return u},o=function(){var e=t.defer(),o=i+"/_api/web/lists/getByTitle('"+f+"')/items?$select=Title,TermDescription&$top=10000",s={method:"GET",url:o,headers:{Accept:"application/json; odata=verbose"}};return n(s).then(function(n){angular.copy(n.data.d.results,r);u=!0;e.resolve(n.data.d.results)},function(){e.reject()}),e.promise},s=function(){var r=t.defer(),u=i+"/_api/web/lists/getByTitle('Settings')/items?$select=Title,Val&$top=10000",f={method:"GET",url:u,headers:{Accept:"application/json; odata=verbose"}};return n(f).then(function(n){r.resolve(n.data.d.results)},function(){r.reject()}),r.promise},h=function(){var r=t.defer(),u=i+"/_api/web/lists/getByTitle('"+f+"')/effectiveBasePermissions",e={method:"GET",url:u,headers:{Accept:"application/json; odata=verbose"}};return n(e).then(function(n){var t=new SP.BasePermissions,i;t.fromJson(n.data.d.EffectiveBasePermissions);i=t.has(SP.PermissionKind.manageLists);r.resolve(i)},function(){r.reject()}),r.promise};return{data:r,getContents:o,getSettings:s,getUserAccess:h,isReady:e}}];n.factory("glossaryDataService",t)}(oppModule=angular.module("app")),function(n){var t=function(){return function(t,i){var r;return i&&i.length>0?(r=[],n.forEach(t,function(t){var u=[];n.forEach(t.value,function(n){var r=n.Title.toLowerCase(),f=n.TermDescription.toLowerCase(),t=i.toLowerCase();(r.indexOf(t)>-1||f.indexOf(t)>-1)&&u.push(n)});t.filtered=[];u.length>0&&(t.filtered=u,r.push(t))}),r):(r=[],n.forEach(t,function(n){n.filtered=n.value;r.push(n)}),r)}};n.module("app").filter("searchTerm",t)}(angular=angular||window.angular),function(n){var t=["glossaryDataService","$sce","$timeout","$window",function(t,i,r,u){var f=this;f.rawData=[];f.settings=[];f.groupedData=[];f.userCanEdit=!1;f.groupData=function(){var n,u,t,i,r;for(f.groupedData=[],n="a".charCodeAt(0),u="z".charCodeAt(0);n<=u;++n)f.groupedData.push({name:String.fromCharCode(n).toUpperCase(),value:[]});for(n=0;n<f.rawData.length;n++)t=f.rawData[n].Title.charAt(0).toUpperCase(),i=$.grep(f.groupedData,function(n){return n.name==t}),i.length>0?i[0].value.push(f.rawData[n]):(r=$.grep(f.groupedData,function(n){return n.name==t}),r.length>0?r[0].value.push(f.rawData[n]):f.groupedData.push({name:t,value:[f.rawData[n]]}))};f.highlight=function(n,t){if(n)return t?i.trustAsHtml(n.replace(new RegExp(t,"gi"),'<span class="highlightedText">$&<\/span>')):i.trustAsHtml(n)};f.init=function(){r(function(){$("#glossaryTitle").is(":visible")||($("#glossaryTitle").show(),$(".glossary-main-container").show())},500);t.getSettings().then(function(t){n.copy(t,f.settings);var i,u,e;n.forEach(f.settings,function(n){n.Title.toUpperCase()=="TITLE"&&(e=n.Val);n.Title.toUpperCase()=="COLOR"&&(i=n.Val);n.Title.toUpperCase()=="COLORHOVER"&&(u=n.Val)});r(function(){e&&($("#glossaryTitle").html(e),$("#glossaryTitle").show());i&&u&&($(".glossary-group-label,.glossary-link.active").css("background-color",i),$(".glossary-link.active").hover(function(n){$(this).css("background-color",n.type==="mouseenter"?u:i)}));$(".glossary-main-container").show()},100)},function(){}).then(function(){f.loading=!1});t.isReady()==!1&&(f.loading=!0,t.getContents().then(function(t){n.copy(t,f.rawData);f.groupData()},function(){}).then(function(){f.loading=!1}));t.getUserAccess().then(function(n){n&&(f.userCanEdit=!0)},function(){})};f.goToSettings=function(){var n=decodeURIComponent(JSRequest.QueryString.SPHostUrl),t=decodeURIComponent(JSRequest.QueryString.SPAppWebUrl);u.location.href="Settings.aspx?SPHostUrl="+n+"&SPLanguage=en%2DUS&SPClientTag=0&SPProductNumber=15%2E0%2E4787%2E1000&SPAppWebUrl="+t};SP.SOD.executeOrDelayUntilScriptLoaded(f.init,"SP.js")}];n.module("app").controller("GlossaryController",t)}(angular=angular||window.angular);