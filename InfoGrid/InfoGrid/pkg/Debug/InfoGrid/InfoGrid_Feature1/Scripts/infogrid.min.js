"use strict";function initializePage(){function n(){hostweburl=decodeURIComponent(JSRequest.QueryString.SPHostUrl);appweburl=decodeURIComponent(JSRequest.QueryString.SPAppWebUrl);var n=[];$.ajax({url:appweburl+"/_api/lists/getByTitle('Settings')/items?$select=Title,Value1",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){if(n.d.results.length>0)for(var t=0;t<n.d.results.length;t++)n.d.results[t].Title==="background-color"&&$("body").css("background-color",n.d.results[t].Value1),n.d.results[t].Title==="max-width"&&$(".infogrid-view-port").css("max-width",n.d.results[t].Value1),n.d.results[t].Title==="title"&&$(".infogrid-view-port h2").text(n.d.results[t].Value1),n.d.results[t].Title==="layout"&&(layout=n.d.results[t].Value1)},error:function(n){alert("Error: "+n)},complete:function(){$("body").css("display","block");$.ajax({url:appweburl+"/_api/lists/getByTitle('Info Grid List')/items?$select=Title,Contents,Attachments,AttachmentFiles&$expand=AttachmentFiles",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(i){var r,u;if(i.d.results.length>0){for(r=0;r<i.d.results.length;r++)u="",i.d.results[r].AttachmentFiles&&i.d.results[r].AttachmentFiles.results.length>0&&(u=i.d.results[r].AttachmentFiles.results[0].ServerRelativeUrl),n.push({title:i.d.results[r].Title,subTitle:i.d.results[r].SubTitle,contents:i.d.results[r].Contents,imageUrl:u});t(n)}else $(".no-items-page").css("display","inline-block")},error:function(n){alert("Error: "+n)}})}});$.ajax({url:appweburl+"/_api/web/lists/getByTitle('Info Grid List')/effectiveBasePermissions",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(n){var t=new SP.BasePermissions,i;t.fromJson(n.d.EffectiveBasePermissions);i=t.has(SP.PermissionKind.manageLists);i&&$(".admin-button").css("display","inline-block")},error:function(){}})}function t(n){var f,e,t,u,i,r,o;if(n.length>0){for(f=$("#tile-template").html(),e=$("#content-template").html(),t=0;t<n.length;t++)u="infogrid-doc-"+(t+1),i=$(f).attr("data-src",n[t].imageUrl),i.find(".mega-title").text(n[t].title),i.find(".fancybox").attr("data-src","#"+u),$("#container").append(i),r=$(e).attr("id",u),r.find(".infogrid-document-image").css("background-image","url("+n[t].imageUrl+")"),r.find(".infogrid-document-content").html(n[t].contents),$("#infogrid-contents").append(r);o=jQuery(".megafolio-container").megafoliopro({delay:20,defaultWidth:980,paddingHorizontal:20,paddingVertical:20,layoutarray:[layout]});$(".mega-entry").on("click",function(n){n.stopPropagation();$.fancybox.open([{href:$(this).find(".fancybox").attr("data-src"),autoSize:!1,width:$(".infogrid-view-port").first().outerWidth(),height:"80%"}],{padding:0})})}}var i=SP.ClientContext.get_current();$(document).ready(function(){JSRequest.EnsureSetup();n()})}function navigateToHost(){window.location=hostweburl}function navigateToList(){window.location=appweburl+"/lists/InfoGridList"}function navigateToSettings(){window.location=appweburl+"/lists/Settings"}function navigateToInstructions(){var n=decodeURIComponent(JSRequest.QueryString.SPHostUrl),t=decodeURIComponent(JSRequest.QueryString.SPAppWebUrl);window.location.href="Instructions.aspx?SPHostUrl="+n+"&SPLanguage=en%2DUS&SPClientTag=0&SPProductNumber=15%2E0%2E4787%2E1000&SPAppWebUrl="+t}ExecuteOrDelayUntilScriptLoaded(initializePage,"sp.js");var hostweburl,appweburl,layout=10;